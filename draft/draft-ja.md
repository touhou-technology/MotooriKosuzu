- [C++リフレクションの使用](#orgb7f958f)
- [翻訳機能](#org9e3515f)
- [LISP](#org68ba9c5)
- [TUI](#org2c3983e)
- [設定の読み込み](#org4984583)
- [](#orgd28fae1)

母語を使ったほうが自分の考えをより正確に表現できると思っています。
それにこれはただの草案です。()
普段はAIを使って翻訳すれば、だいたい意味は正確に伝わると思います。
もし曖昧な点や分かりにくいところがあれば、<awalwashig@gmail.com> にメールを送ってください。
（ただしGFWの影響があるため、Emacsとうまく統合できておらず、メールを確認するまでかなり時間がかかるかもしれません）

それでも、このプロジェクトは以前学んだ内容を練習する目的（~~just for fun~~）でもあります。
なので多少の粗さはあるかもしれませんが、実際に自分が使う視点から、どのように機能を実装するか（つまりユーザー視点）を考えていくつもりです。

以下は実装予定の機能です。


<a id="orgb7f958f"></a>

# C++リフレクションの使用

- リフレクションを使う理由：
  Remember, one of the most important principles in programming is the same as one of the most important principles in sorcery, all right? That's if you have the name of the spirit, you get control over it. - Hal Abelson
  ~~知らないわ~~~ そんな魔法！~~
  個人的には単にリフレクションを触ってみたいというのもあります ^^
  いくつかのアイデアを試す実験でもあります。
  現在のGCCのリフレクションはまだ実験的で、LSPもサポートされていませんが、
  ~~でも正直、LSPがむしろ邪魔している気もする（英語がもっと得意ならそう感じないのかもしれませんが）~~


<a id="org9e3515f"></a>

# 翻訳機能

- 複数の翻訳APIを呼び出して切り替え可能にする（言語によって得意なAPIが違うかもしれない）
- 個人的にはプログラム可能にしたい → LISPを使用（後述）
- メッセージのマッピングは必要だと思うが、いくつかの制約を満たす必要がある
  必ず対応関係が取れるようにする必要がある。制約については、デバッグ可能な機能を追加する予定 <LISP>
- 実験的（~~just for fun~~）に分散計算で ASR → 翻訳 を実装
  ASRの精度はそこまで高くないかもしれないが、会話目的なら問題ないと思う
  双方で3回程度の確認をすれば十分
  DiscordのbotはVC内の会話をリッスンできるので、
  [Discord Activities](https://docs.discord.com/developers/activities/overview) + [whisper.cpp<sub>wasm</sub>](https://ggml.ai/whisper.cpp/stream.wasm/) を使うことも可能
  あるいはポイント制の戦略も考えられる（この点は実装してから検討）


<a id="org68ba9c5"></a>

# LISP

- LISP？ Code as Data!
  設定ファイルでコードの挙動を制御するやり方にはあまり慣れていません。
  （設定ファイル方式だと、基本的に自分しか書き方を理解できず、後期メンテナンスが大変になる
  ~~主に自分が面倒くさがりだから~~）
  見ただけでどう動くか分かる形にしたい（つまりリフレクション？）
  これも実験的なプロジェクトです。
- Command
  Discordに機能を登録（あるいは dishell のような形）
  また、[オートコンプリート](https://dpp.dev/application-command-autocomplete.html) を提供
  Commandはユーザー自身が書けるようにする
- Hook
  eventが発生したときにコールバック関数を提供


<a id="org2c3983e"></a>

# TUI

- なぜTUIを作るのか
  C++のリフレクションのおかげで、TUIがクラスの実装やメンバーを探索できる
  （つまりコードがコードを見るようなもの <自己参照性>）
  そのため設定を、一目で理解できる形に抽象化できる
  （Plan9の操作を組み込みたい気持ちもあるが、UIとしては多くの人が慣れている形に設計する予定）
- ユーザー側
  [Discord Activities](https://docs.discord.com/developers/activities/overview) を使ってTUIを構築するか、
  あるいは静的サイトにアクセスして wasm を直接利用する


<a id="org4984583"></a>

# 設定の読み込み

- ~~初期化~~
  初期化の前に設定を読み込む必要がある。
  ただし alpine はランタイムで書き込み不可のファイルシステムなので、
  動作を固定して変更不可にするか（再起動で消える）、
  読み込んだ後に保存することはできない可能性がある。
  しかし見落としていたことがある。
  ほぼ無限に設定を保存できる場所があるのでは？
  それは Discord に設定を投稿すること。
  最初の起動時の設定に、そのメッセージのリンクを書いておく。
  変更したい場合は、自分でメッセージを編集すればよい（自分の投稿）。
  あるいは bot が設定メッセージを投稿し、それを編集する形でもよい。
- 順序
  - boot
    1 **etc/MotooriKosuzu/config**
    2 ~/.config/
    3 ./config/
        - Init.el Discord Message URL

その後、lispで自由に設定可能
（通常、ユーザーはほとんどの機能を使えないようにすることもできるし、
自己参照性を使ってセンシティブな機能を削除することもできる）


<a id="orgd28fae1"></a>

# TODO

まだ未完成な部分があると思います。
